# Stateful приложения

Если Stateful запущен в несколько инстансов
- Случайные имена которые задает ReplicaSet (случайный суффикс)
- Одинаковый конфиг для всех подов
- Один том на все поды
- Поды создаются в произвольном порядке (могут быть проблемы инициализации при первоначальном запуске)
- Нет прямого доступа к поду, только доступ к случайному поду через сервис

## Statefulset
- Стабильные имена (name-0, name-1, name-2)
- Постоянные уникальные хранилища (volumeClaimTemplates) - тогда для каждого пода создается свой собственный PersistentVolumeClaim 
Если pod был удален и создан новый с таким же индексом то к этому поду будет подключен уже существующий том с сохраненными данными
Что бы обновить информацию нужно удалять старый pvc вручную
- Упорядоченное создание и удаление. Стратегия изменения количества подов указывается в поле podManagementPolicy 
Есть две стратегии: OrderedReady или Parallel
- Упорядоченное обновление - поле updateStrategy
onDelete - устаревшая (при обновлении манифеста ничего не происходит), для обновления пода его надо удалить вручную
rolllingUpdate (по умолчанию) - при обновлении начинается обновление подов по одному начиная с подов с наибольшим индексом.
partition - можно указать количество подов которые не будут затронуты обновлением (Если указываем 3 то поды 0,1,2 yt будут обновляться)
- Отправка запроса на определенный pod - headless service - это сервис у которого в поле clusterIp: none. Для таких сервисов не создаются правила а iptables, но создаются dns записи. 

## Приложения и баз данных для облаков
- Relational
Percona XtraDB Cluster + MariaDB Foundation - Это MySQL

- NoSQL
mongoDB

- In-memory db
redis, Memcashe

- Message Queue
RabbitMQ

- Search engine
elasticsearch

- Service Discovery
etcd  
consul  
ZooKeeper
